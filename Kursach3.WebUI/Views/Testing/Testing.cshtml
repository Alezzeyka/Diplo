@using Kursach3.WebUI.Models
@using Kursach3Domain.Entities
@using Kursach3.WebUI.HtmlHelpers
@model Kursach3.WebUI.Models.QuestionListviewModel
@{
    Layout = "~/Views/Shared/_TestingLayout.cshtml";
    ViewBag.Title = "Тест " + Model.Test.Category + " " + Model.Test.Course;
    int i = 1;
}
@using (Html.BeginForm("TestResult", "Testing"))
{
    @Html.Hidden("Id",Model.Test.Id);
    @Html.Hidden("listviewModel", Model);
    <h1>Вопросы</h1>
    <p>Выберите вопрос и в каждом вопросе выберите вариант ответа</p>
    <ul class="nav nav-tabs">
        @foreach (var p in Model.Questions)
        {
            string s = "#nav-quest" + p.Id.ToString();
            if (i == 1)
            {
                <li class="nav-item">
                    <a class="navbar-link active" data-toggle="tab" href=@s>@i</a>
                </li>

            }
            else
            {
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href=@s>@i</a>
                </li>

            }
            i = i + 1;
        }
    </ul>
    i = 1;
    <div class="tab-content">
        @foreach (var p in Model.Questions)
        {
            string s = "nav-quest" + p.Id.ToString();
            
                <div class="tab-pane fade active" id=@s>
                    <div class="jumbotron">
                    <p class="lead"><strong>@p.QuestionForm</strong></p>
                    @if (p.ImgId != 0)
                    {
                        Picture picture = Model.pictures.First(x => x.Id == p.ImgId);
                        <div class="img-thumbnail">@Html.Raw("<img style='width:150px; height:250px;'vspace='5' hspace='5' src=\"data:image/jpeg;base64," + Convert.ToBase64String(picture.Image) + "\"/>")</div>
                    }

                    @foreach (var a in Model.Answers.Where(x => x.QuestionID == p.Id))
                    {
                        string name = "answer" + i;
                        string value = a.IsCorrect.ToString() + ":" + a.Id + ":" + a.QuestionID + ":" + p.TestID+":"+a.AnswerScore;
                        <input name="@name" type="radio" value="@value" required>
                        <span>@a.AnswerForm</span> <br />
                    }
                    </div>
                </div>
            i = i + 1;
        }
    </div>
    <div class="panel panel-footer text-center" style="margin-bottom:10%;">
    <input class="btn btn-success btn-block btn-lg " type="submit" value="Ответить">
    @Html.ActionLink("прекратить тест и вернуться назад", "List", "Test", null,
new { @class = "btn btn-warning btn-block btn-lg" })
    </div>
}



